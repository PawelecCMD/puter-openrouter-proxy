<html>
<head>
    <title>üíª Cline ‚Äì Tw√≥j AI Terminal</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #0f0;
            padding: 20px;
            margin: 0;
        }
        #terminal {
            height: 70vh;
            overflow-y: auto;
            border: 1px solid #0f0;
            padding: 10px;
            margin-bottom: 10px;
            white-space: pre-wrap;
        }
        #cmd {
            width: 100%;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            background: #111;
            color: #0f0;
            border: 1px solid #0f0;
        }
        .prompt { color: #0ff; }
        .output { color: #fff; }
        .error { color: #f00; }
    </style>
</head>
<body>
    <div id="terminal"></div>
    <input id="cmd" placeholder="Wpisz komendƒô... (np. help)" autofocus>

    <!-- Puter.js SDK -->
    <script src="https://js.puter.com/v2/"></script>
    <script>
        const term = document.getElementById('terminal');
        const input = document.getElementById('cmd');

        function log(text, type = '') {
            const line = document.createElement('div');
            line.className = type;
            line.textContent = text;
            term.appendChild(line);
            term.scrollTop = term.scrollHeight;
        }

        function help() {
            log('üìö DOSTƒòPNE KOMENDY:', 'prompt');
            log('  help           ‚Äì poka≈º pomoc');
            log('  ls             ‚Äì lista plik√≥w');
            log('  put <nazwa>    ‚Äì utw√≥rz pusty plik');
            log('  cat <nazwa>    ‚Äì wy≈õwietl zawarto≈õƒá pliku');
            log('  ai "pytanie"   ‚Äì zapytaj AI (np. ai "napisz kod Python")');
            log('  host           ‚Äì opublikuj folder jako stronƒô');
            log('  clear          ‚Äì wyczy≈õƒá terminal');
        }

        async function ls() {
            try {
                const files = await puter.fs.list('/');
                if (files.length === 0) {
                    log('üìÅ Brak plik√≥w.', 'output');
                } else {
                    log('üìÅ Pliki: ' + files.map(f => f.name).join(', '), 'output');
                }
            } catch (e) {
                log('‚ùå B≈ÇƒÖd: ' + e.message, 'error');
            }
        }

        async function put(filename) {
            if (!filename) return log('‚ùå U≈ºycie: put <nazwa>', 'error');
            try {
                await puter.fs.write(filename, '');
                log(`‚úÖ Utworzono plik: ${filename}`, 'output');
            } catch (e) {
                log('‚ùå B≈ÇƒÖd: ' + e.message, 'error');
            }
        }

        async function cat(filename) {
            if (!filename) return log('‚ùå U≈ºycie: cat <nazwa>', 'error');
            try {
                const blob = await puter.fs.read(filename);
                const content = await blob.text();
                log(`üìÑ Zawarto≈õƒá ${filename}:\n${content}`, 'output');
            } catch (e) {
                log(`‚ùå Plik "${filename}" nie istnieje.`, 'error');
            }
        }

        async function ai(prompt) {
            if (!prompt) return log('‚ùå U≈ºycie: ai "twoje pytanie"', 'error');
            log(`üß† Pytam AI: ${prompt}`, 'prompt');
            try {
                const resp = await puter.ai.chat(prompt, { model: 'gpt-4o', stream: true });
                let full = '';
                for await (const part of resp) {
                    if (part.text) {
                        full += part.text;
                        term.lastChild.textContent = `üß† Odpowied≈∫:\n${full}`;
                    }
                }
            } catch (e) {
                log('‚ùå B≈ÇƒÖd AI: ' + e.message, 'error');
            }
        }

        async function host() {
            const subdomain = puter.randName();
            try {
                const site = await puter.hosting.create(subdomain, '/');
                log(`üåê Strona opublikowana pod:\nhttps://${site.subdomain}.puter.site`, 'output');
            } catch (e) {
                log('‚ùå B≈ÇƒÖd hostingu: ' + e.message, 'error');
            }
        }

        function clear() {
            term.innerHTML = '';
            log('Terminal wyczyszczony.', 'output');
        }

        // Obs≈Çuga wpisywania komend
        input.addEventListener('keydown', async (e) => {
            if (e.key === 'Enter') {
                const cmd = input.value.trim();
                if (!cmd) return;
                log(`> ${cmd}`, 'prompt');
                input.value = '';

                const args = cmd.split(' ');
                const command = args[0].toLowerCase();
                const rest = args.slice(1).join(' ').replace(/"/g, '');

                switch (command) {
                    case 'help': help(); break;
                    case 'ls': await ls(); break;
                    case 'put': await put(args[1]); break;
                    case 'cat': await cat(args[1]); break;
                    case 'ai': await ai(rest); break;
                    case 'host': await host(); break;
                    case 'clear': clear(); break;
                    default: log(`‚ùå Nieznana komenda: ${command}. Wpisz 'help'.`, 'error');
                }
            }
        });

        // Start
        log("üíª Witaj w Cline ‚Äì Twoim AI terminalu!");
        log("Wpisz 'help' by zobaczyƒá dostƒôpne komendy.");
    </script>
</body>
</html>
